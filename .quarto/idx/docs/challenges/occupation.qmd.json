{"title":"Occupations of Black and White Americans in Georgia.","markdown":{"yaml":{"title":"Occupations of Black and White Americans in Georgia."},"headingText":"Table","containsRefs":false,"markdown":"\n\nThis plate shows the percentages of black and white Americans employed in different industries. One of the more striking data insights is the much greater proportion of black Americans employed as domestic servants when compared to white Americans.\n\nThis is one of DuBois' more striking graphs in appearance, with its \"fan-like\" shape. You can almost think of it like a pie chart with some wedges cut out. I personally found this such a unique geometry that I chose it as [my contribution](https://twitter.com/JDavison_/status/1361630455519444996) of the DuBois Data Challenge in 2021.\n\nSadly, this is quite a challenging geometry to transform into a tabular format. What I wanted to capture was the double comparison it codifies --- the white percentage vs. the black percentage, but also the individual industry vs the other industries. I also wanted to capture the symmetry of the plate, and the way the plate has rotational symmetry rather than being reflected along a horizontal line (e.g., the red panels are opposite each other, creating a hourglass shape, rather than both being on the left or right of their respective wedge).\n\nTo try to capture the feel of all of this, I expressed it as what I might call \"duelling bars\"^[Please let me know if there is already a term for this!] --- effectively two in-line bar charts where `x = 0` is at opposite sides and `x = 100` meet in the middle. It is the opposite of how a pyramid population chart looks, where `x = 0` is in the middle.\n\nThe end result is a lot less visually interesting than than the original plate, and I'd argue the weakest recreation. I'd be interested to see if others could interpret it more faithfully.\n\n::: {.panel-tabset}\n\n\n```{r, ref.label=c('occupationCode')}\n#| label: occupationTbl\n#| echo: false\n```\n\n# Original\n\n![](https://raw.githubusercontent.com/ajstarks/dubois-data-portraits/master/challenge/challenge03/original-plate-27.jpg)\n\n# Code\n\n```{r}\n#| label: occupationCode\n#| eval: false\n\nlibrary(tidyverse)\nlibrary(gt)\n\n# read data\noccupation <-\n  readr::read_csv(\n    'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-16/occupation.csv'\n  ) |>\n  mutate(Occupation = factor(\n    Occupation,\n    c(\n      \"Agriculture, Fisheries and Mining\",\n      \"Domestic and Personal Service\",\n      \"Manufacturing and Mechanical Industries\",\n      \"Trade and Transportation\",\n      \"Professions\"\n    )\n  )) |>\n  arrange(Occupation) |>\n  # language\n  mutate(Group = case_when(Group == \"Negroes\" ~ \"Black\",\n                           Group == \"Whites\" ~ \"White\"))\n\n# function to create bars\nplot_bars <- function(data, color) {\n  data |>\n    mutate(Percentage = if_else(Group == \"White\", Percentage * -1, Percentage)) |>\n    ggplot() +\n    geom_col(alpha = .25, aes(y = \"\", x = if_else(Group == \"White\",-100, 100)), fill = \"grey85\") +\n    geom_col(alpha = .85, aes(y = \"\", x = Percentage), fill = color) +\n    facet_wrap(vars(Group), scales = \"free_x\") +\n    theme_void() +\n    theme(strip.text = element_blank(), panel.grid.major.x = element_line()) +\n    scale_y_discrete(expand = expansion()) +\n    scale_x_continuous(breaks = c(c(0, 25, 50, 75, 100), c(0, 25, 50, 75, 100) * -1))\n}\n\n# plot bars\nplots <-\n  occupation |>\n  group_split(Occupation) |>\n  map2(.y = c(\"#b92e43\", \"#edc120\", \"#6a78a5\", \"#e0d5c3\", \"#a69077\"),\n       plot_bars)\n\n# prep data for table\ntbl_data <- \n  occupation |>\n  # reshape\n  pivot_wider(names_from = Group, values_from = Percentage) |>\n  mutate(plots = NA, .after = Black) |>\n  # add HTML\n  mutate(\n    Occupation = toupper(Occupation),\n    Occupation = str_replace(\n      Occupation,\n      \"AGRICULTURE\",\n      \"<b style='color:#b92e43'>AGRICULTURE</b>\"\n    ),\n    Occupation = str_replace(\n      Occupation,\n      \"DOMESTIC\",\n      \"<b style='color:#edc120'>DOMESTIC</b>\"\n    ),\n    Occupation = str_replace(\n      Occupation,\n      \"MANUFACTURING\",\n      \"<b style='color:#6a78a5'>MANUFACTURING</b>\"\n    ),\n    Occupation = str_replace(Occupation,\n                             \"TRADE \",\n                             \"<b style='color:#e0d5c3'>TRADE </b>\"),\n    Occupation = str_replace(\n      Occupation,\n      \"PROFESSIONS\",\n      \"<b style='color:#a69077'>PROFESSIONS</b>\"\n    )\n  )\n\n# make table\ntbl_data |> \n  gt() |>\n  gtExtras::gt_theme_538() |>\n  cols_label(plots = \"\") |>\n  cols_width(plots ~ px(250)) |>\n  cols_align(\"left\", columns = \"White\") |>\n  fmt_percent(c(White, Black), scale_values = FALSE, decimals = 1) |>\n  fmt_markdown(Occupation) |>\n  tab_header(toupper(\"Occupations of Black and White Americans in Georgia.\")) |>\n  tab_options(heading.align = \"center\") |>\n  text_transform(cells_body(plots),\n                 function(x) {\n                   ggplot_image(plots, height = px(25), aspect_ratio = 8)\n                 })\n\n```\n\n:::"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":false,"output-file":"occupation.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.189","theme":"cosmo","title":"Occupations of Black and White Americans in Georgia."},"extensions":{"book":{"multiFile":true}}}}}