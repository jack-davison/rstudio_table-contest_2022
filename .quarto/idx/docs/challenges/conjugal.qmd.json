{"title":"Conjugal Condition.","markdown":{"yaml":{"title":"Conjugal Condition."},"headingText":"Table","containsRefs":false,"markdown":"\n\nThis plate shows the marital status of black Americans, compared to that of Germans. The plate shows clearly that a greater proportion of younger black Americans are married when compared to younger Germans, but older black Americans appear more likely to find themselves divorced or widowed.\n\nUnlike many of DuBois' graphs, which contain many stylistic elements uncommon in modern data visualisations like spiralling bars and fan charts, this plate shows something quite straightforward. Stacked bars are a very common visualisation, and the horizontal iteration of them is already quite tabular!\n\nTranslating to `{gt}` was not too difficult! I used colour in the column labels in place of a legend to keep things simple and elegant, and the \"groupname_col\" argument to collect the different age bins together. DuBois effectively used footnotes to note that the age ranges weren't quite the same for the black Americans, so I used `tab_footnote()` to display the same information.\n\n::: {.panel-tabset}\n\n\n```{r, ref.label=c('conjugalCode')}\n#| label: conjugalTbl\n#| echo: false\n```\n\n# Original\n\n![](https://raw.githubusercontent.com/ajstarks/dubois-data-portraits/master/challenge/challenge02/original-plate-10.jpg)\n\n# Code\n\n```{r}\n#| label: conjugalCode\n#| eval: false\n\nlibrary(tidyverse)\nlibrary(gt)\n\nconjugal <-\n  readr::read_csv(\n    'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-16/conjugal.csv'\n  ) |> \n  mutate(Population = str_replace_all(Population, \"Negroes\", \"Black America\"),\n         Population = factor(Population, c(\"Germany\", \"Black America\")))\n\nmake_bar <- function(data) {\n  data |>\n    pivot_longer(-c(Population:Age)) |>\n    ggplot(aes(y = \"\", x = value)) +\n    geom_col(aes(fill = name), color = \"white\", size = 20) +\n    # geom_text(aes(label = if_else(value >= 20, as.character(value), \"\")),\n    #           position = position_stack(vjust = .5), size = 30) +\n    scale_fill_manual(\n      values = c(\n        \"Single\" = \"#953e45\",\n        \"Married\" = \"#daac2e\",\n        \"Divorced and Widowed\" = \"#647867\"\n      )\n    ) +\n    scale_x_continuous(expand = expansion()) +\n    theme_void() +\n    theme(legend.position = \"none\")\n}\n\nplots <- conjugal |>\n  group_split(Age, Population) |>\n  map(make_bar)\n\nconjugal |>\n  mutate(plot = NA,\n         Age = paste(\"Age\", Age)) |>\n  relocate(Age) |>\n  gt::gt(groupname_col = \"Age\") |>\n  gtExtras::gt_theme_538() |>\n  tab_header(toupper(\"Conjugal Condition.\")) |>\n  tab_footnote(\"45-69\",\n               gt::cells_body(Population, 4)) |>\n  tab_footnote(\"65 AND OVER\",\n               gt::cells_body(Population, 6)) |>\n  fmt_percent(Single:`Divorced and Widowed`,\n              scale_values = FALSE,\n              decimals = 1) |>\n  cols_width(plot ~ px(200),\n             Population ~ px(110),\n             Single:`Divorced and Widowed` ~ px(90)) |>\n  cols_label(\n    \"Divorced and Widowed\" = html(\n      \"<b style='color:#647867'>W</b>idowed/<br><b style='color:#647867'>D</b>ivorced\"\n    ),\n    \"Population\" = \"\",\n    \"plot\" = \"\",\n    \"Single\" = html(\"<b style='color:#953e45'>S</b>ingle\"),\n    \"Married\" = html(\"<b style='color:#daac2e'>M</b>arried\")\n  ) |>\n  cols_align(\"left\", Population) |>\n  text_transform(cells_body(plot),\n                 function(x) {\n                   ggplot_image(plots, height = px(20), aspect_ratio = 8)\n                 }) |>\n  text_transform(cells_body(Population),\n                 function(x) {\n                   toupper(x)\n                 }) |>\n  tab_options(\n    heading.align = \"center\",\n    table_body.border.bottom.width = 10,\n    table_body.border.bottom.color = \"white\",\n    footnotes.padding.horizontal = 25,\n    footnotes.multiline = FALSE,\n    footnotes.sep = \"     \"\n  )\n```\n\n:::"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":false,"output-file":"conjugal.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.189","theme":"cosmo","title":"Conjugal Condition."},"extensions":{"book":{"multiFile":true}}}}}