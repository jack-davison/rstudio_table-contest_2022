{"title":"Proportion of Freemen and Slaves Among Black Americans.","markdown":{"yaml":{"title":"Proportion of Freemen and Slaves Among Black Americans.","editor_options":{"chunk_output_type":"console"}},"headingText":"Table","containsRefs":false,"markdown":"\n\nThis plate shows the proportion of black Americans who were freemen across the decades from 1790 to 1870. The most striking feature of the original plate is how the proportion of enslaved black Americans remained so constant until 1870, when the abolishment of slavery came into effect.\n\nWhile telling a very powerful story, the underlying data is actually very simple --- it is effectively two variables (the decade and the percentage of black \"freemen\"). Instead of tabulating this data as-is and creating in-line visualisations (likely stacked bars), I wonder if the cells of a table itself could be used to recreate the striking geometry of the plate.\n\nThis required using `{gt}` in quite a hacky way, but I effectively created a matrix of `TRUE` and `FALSE` values which could then be coloured either green or black. This recreated the image of the original plot. Is this a particularly good table? Not really! Would it be better as a plot? Almost certainly! But the idea of drawing a graph by colouring cells is at least interesting, and has been used in creative ways before (for example, in Milos Vilotic's [histable](https://capandchange.shinyapps.io/histable/).)\n\n::: {.panel-tabset}\n\n\n```{r, ref.label=c('freedSlavesCode')}\n#| label: freedSlavesTbl\n#| echo: false\n```\n\n# Original\n\n![](https://raw.githubusercontent.com/ajstarks/dubois-data-portraits/master/challenge/challenge04/original-plate-51.jpg)\n\n# Code\n\n```{r}\n#| label: freedSlavesCode\n#| eval: false\n\nlibrary(tidyverse)\nlibrary(gt)\n\nfreed_slaves <-\n  readr::read_csv(\n    'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-16/freed_slaves.csv'\n  )\n\nlabs_df <- \n  mutate(freed_slaves,\n         label = str_glue(\"<b>{Year}</b><br>\n                          <span style='color:#1c1c1c'>{round(Slave)}</span>% | \n                          <span style='color:#6c986f'>{round(Free)}</span>%\"))\n\nlong <- crossing(a = letters, b = letters) |> unite(a, a, b) |> pull()\n\npad <- function(vec) {\n  if (length(vec) < 100) {\n    append(vec, rep(FALSE, 100 - length(vec)))\n  }\n}\n\nlst <-\n  freed_slaves |>\n  select(Slave) |>\n  mutate(Slave = round(Slave / 1) * 1,\n         Slave = Slave / 1) |>\n  pull(Slave) |>\n  map(~ rep(TRUE, .x)) |>\n  map(pad) |>\n  map( ~ set_names(.x, long[1:100]))\n\ntbl_dat <-\n  tibble(lst) |>\n  unnest_wider(lst) |>\n  mutate(rownum = row_number()) |>\n  pivot_longer(-rownum) |> pivot_wider(names_from = rownum) |>\n  arrange(desc(name)) |>\n  select(-name) |>\n  set_names(labs_df$Year)\n\ngt(tbl_dat) |>\n  gtExtras::gt_theme_538() |>\n  data_color(columns = everything(),\n             colors = scales::col_numeric(\n               palette = c(\"#6c986f\", \"#1c1c1c\"),\n               domain = 0:1\n             )) |>\n  text_transform(cells_body(),\n                 function(x) {\n                   \"\"\n                 }) |>\n  tab_options(\n    data_row.padding = 3,\n    table_body.hlines.width = 0,\n    heading.align = \"center\"\n  ) |>\n  tab_header(\n    title = md(\n      \"PROPORTION OF <span style='color:#6c986f'>FREEMEN</span> AND SLAVES AMONG BLACK AMERICANS.\"\n    ),\n    subtitle = \"DONE BY ATLANTA UNIVERSITY.\"\n  ) |>\n  cols_width(everything() ~ px(75)) |>\n  cols_label(\n    `1790` = md(labs_df$label[1]),\n    `1800` = md(labs_df$label[2]),\n    `1810` = md(labs_df$label[3]),\n    `1820` = md(labs_df$label[4]),\n    `1830` = md(labs_df$label[5]),\n    `1840` = md(labs_df$label[6]),\n    `1850` = md(labs_df$label[7]),\n    `1860` = md(labs_df$label[8]),\n    `1870` = md(labs_df$label[9])\n  )\n```\n\n:::"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":false,"output-file":"freed_slaves.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.189","theme":"cosmo","title":"Proportion of Freemen and Slaves Among Black Americans.","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}}}